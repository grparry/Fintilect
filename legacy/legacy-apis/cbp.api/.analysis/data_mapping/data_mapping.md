---
type: data_mapping
project: cbp.api
created_date: 2025-01-03T16:35:23-07:00
status: verified
risk_level: critical
references:
  - ../domain_models/domain_models.md
  - ../business_rules/enhanced_validation_rules.md
last_verified: 2025-01-03T16:35:23-07:00
---

# CBP API Data Mapping Rules

## Currently Implemented Mappings

### Configuration Mappings
```yaml
implementation:
  configuration:
    request_to_model:
      - ConfigurationAddRequest → Configuration
      - ConfigurationUpdateRequest → Configuration
    ignored_fields:
      - Id: "Generated by system"
      - LastChangeDate: "System managed"
```

### Payee Mappings
```yaml
implementation:
  global_payee:
    model_to_response:
      - GlobalPayee → PayeeResponse
      - GlobalPayee → GlobalPayeeResponse
    field_mappings:
      - InternalPayeeId → PayeeId
      - Ofacstatus → OfacStatus
    ignored_fields:
      - PayeeType: "Set by service"

  personal_payee:
    model_to_response:
      - PersonalPayee → PayeeResponse
      - PersonalPayee → PersonalPayee
    ignored_fields:
      - PayeeType: "Set by service"
      - Id: "Generated by system"
```

### Payment Mappings
```yaml
implementation:
  payment:
    model_to_history:
      - Payment → PaymentChangeHistory
      - Payment → PaymentHistory
    field_mappings:
      - Id → PaymentId
    ignored_fields:
      - Id: "Generated by system"

  recurring_payment:
    model_to_history:
      - RecurringPayment → RecurringPaymentChangeHistory
    field_mappings:
      - Id → RecPaymentId
    ignored_fields:
      - Id: "Generated by system"
```

### User Payee Mappings
```yaml
implementation:
  user_payee:
    model_to_response:
      - UserPayeeData → UserPayeeResponse
      - UserPayeeList → UserPayeeListChangeHistory
      - UserPayeeList → PaymentHistory
    field_mappings:
      - Id → UserPayeeListId
    ignored_fields:
      - Id: "Generated by system"
      - Payee: "Loaded separately"
```

## Missing Data Mappings

### Member Mappings
```yaml
documented_rules:
  member:
    rule: "Member data mapping"
    verification_status: not_found
    expected_mappings:
      - Member → MemberResponse
      - Member → MemberHistory
      - MemberAccount → AccountResponse
    impact: "No member data validation"
```

### Transaction Mappings
```yaml
documented_rules:
  transaction:
    rule: "Transaction data mapping"
    verification_status: not_found
    expected_mappings:
      - Transaction → TransactionResponse
      - Transaction → TransactionHistory
      - TransactionStatus → StatusResponse
    impact: "No transaction tracking"
```

### Validation Mappings
```yaml
documented_rules:
  validation:
    rule: "Validation data mapping"
    verification_status: not_found
    expected_mappings:
      - ValidationRule → ValidationResponse
      - ValidationResult → ResultResponse
      - ValidationError → ErrorResponse
    impact: "Limited validation tracking"
```

### Integration Mappings
```yaml
documented_rules:
  integration:
    rule: "External system mapping"
    verification_status: not_found
    expected_mappings:
      - ExternalPayee → PayeeResponse
      - ExternalAccount → AccountResponse
      - ExternalTransaction → TransactionResponse
    impact: "Limited external system integration"
```

## Verification Notes

1. Current Implementation Status:
   - Basic CRUD operation mappings
   - Simple history tracking mappings
   - Limited validation mappings
   - No complex transformations

2. Missing Critical Mappings:
   - No member domain mappings
   - No transaction mappings
   - Limited validation mappings
   - No external system mappings

3. Implementation Gaps:
   - Limited field validation
   - No complex transformations
   - Missing business rule mappings
   - Basic history tracking

4. Risk Assessment:
   - Missing critical domain mappings
   - Limited validation in mappings
   - Basic history implementation
   - No external system validation
